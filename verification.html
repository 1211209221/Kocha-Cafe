<?php session_start() ?>

<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <link rel="icon" href="register/logo_icon.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Fonts -->
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Raleway:300,400,600" rel="stylesheet" type="text/css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    
    <!-- Custom Styles -->
    <style>
        body {
            background: rgb(244, 254, 232);
            font-family: 'Raleway', sans-serif;
        }
        .login-form {
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .card {
            width: 450px;
            border-radius: 3mm;
            border: 0.4mm solid rgb(28, 58, 64);
            background: rgb(255, 255, 255);
            padding: 20px;
            box-shadow: rgba(50, 50, 93, 0.25) 0px 6px 12px -2px,
                        rgba(0, 0, 0, 0.3) 0px 3px 7px -3px;
        }
        .card-header {
            font-size: 24px;
            color: rgb(28, 58, 64);
            font-weight: 500;
            text-align: center;
            margin-bottom: 20px;
        }
        .form-control {
            border-radius: 0.25rem;
            height: 40px;
        }
        .form-group label {
            font-weight: 500;
            color: rgb(28, 58, 64);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .btn {
            width: 100%;
            background: rgb(28, 58, 64);
            color: white;
            padding: 10px;
            font-size: 16px;
            border-radius: 1mm;
            cursor: pointer;
        }
        .btn:hover {
            background: rgb(130, 190, 87);
            color: white;
        }
        .alert {
            text-align: center;
            color: red;
            margin-top: 10px;
        }
        .center {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
        }
        .icon {
            text-align: center;
            margin-bottom: 10px;
        }
        .icon span {
            font-size: 40px;
            color: rgb(233, 126, 81);
        }
        .title {
            font-family: 'Poppins', sans-serif;
            font-size: 20px;
            color: rgb(28, 58, 64);
            font-weight: 500;
            margin-bottom: 3px;
        }
        .subtitle {
            font-family: 'Poppins', sans-serif;
            font-size: 13px;
            color: rgb(98, 98, 98);
        }
        .input-fields {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            flex-grow: 1;
        }
        .inputs {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-evenly;
        }
        .inputs input {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            outline: 0.4mm solid rgba(28, 58, 64, 0.7);
            text-align: center;
            font-family: 'Poppins', sans-serif;
            background: white;
            font-size: 18px;
        }
        .inputs input:focus {
            outline: 0.4mm solid rgba(130, 190, 87);
        }
        .inputs input:valid {
            background: rgb(130, 190, 87);
            color: white;
            outline: 0.4mm solid rgb(130, 190, 87);
        }
        .timer {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            color: rgb(98, 98, 98);
            margin: 10px 0;
        }
        .timer button {
            background: none;
            outline: none;
            border: none;
            color: rgb(98, 98, 98);
            font-family: 'Poppins', sans-serif;
            text-decoration: underline;
            cursor: pointer;
        }
        .timer button:disabled {
            color: rgb(200, 200, 200);
            cursor: auto;
        }
        .timer .time {
            width: 30px;
        }
        .btn {
            width: 100%;
            background: rgb(28, 58, 64);
            color: white;
            padding: 5px 0;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            border-radius: 1mm;
            cursor: pointer;
        }
        .status {
            position: absolute;
            width: 0;
            height: 100%;
            top: 0;
            left: 0;
            background: rgb(28, 58, 64);
            border-radius: 2mm;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            overflow: hidden;
            transition: 0.35s;
        }
        .status span {
            font-size: 80px;
            width: 80px;
            color: rgb(249, 244, 60);
        }
        .success {
            color: white;
        }
    </style>

    <title>Verification</title>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light navbar-laravel">
    <div class="container">
        <a class="navbar-brand" href="#">Verification Account</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</nav>

<main class="login-form">
    <div class="center">
        <form action="#" method="POST">
            <div class="icon">
                <span class="material-icons">rocket</span>
            </div>
            <div class="head">
                <div class="title">Please check your email</div>
                <div class="subtitle">We've sent a code to snippets@gmail.com</div>
            </div>
            <div class="input-fields">
                <div class="inputs">
                    <input type="text" class="input" required pattern="[0-9]*" maxlength="1"/>
                    <input type="text" class="input" required pattern="[0-9]*" maxlength="1"/>
                    <input type="text" class="input" required pattern="[0-9]*" maxlength="1"/>
                    <input type="text" class="input" required pattern="[0-9]*" maxlength="1"/>
                    <input type="text" class="input" required pattern="[0-9]*" maxlength="1"/>
                    <input type="text" class="input" required pattern="[0-9]*" maxlength="1"/>
                </div>
            </div>
            <div class="timer">
                <button disabled>Resend in <span class="time">60</span> seconds</button>
            </div>
            <div class="btn">
                Verify
            </div>
            <div class="status" id="status">
                <span class="material-icons"> done_outlined </span>
                <div class="title success">Hooray!</div>
                <div class="subtitle success">Verification Successful</div>
            </div>
        </form>
    </div>
</main>

</body>
</html>
<?php 
    include('connect.php');
    if(isset($_POST["verify"])){
        $otp = $_SESSION['otp'];
        $email = $_SESSION['mail'];
        $otp_code = $_POST['otp_code'];

        if($otp != $otp_code){
            ?>
           <script>
               alert("Invalid OTP code");
           </script>
           <?php
        }else{
            mysqli_query($conn, "UPDATE customer SET status = 1 WHERE cust_email = '$email'");
            ?>
             <script>
                 alert("Verfiy account done, you may sign in now");
                   window.location.replace("login.php");
             </script>
             <?php
        }

    }

?>